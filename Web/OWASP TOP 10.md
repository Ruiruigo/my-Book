# OWASP TOP 10

##  注入 Injection

### 原理

​	注入攻击漏洞往往是应用程序缺少对输入进行安全性检查所引起的。攻击者把一些包含攻击代码当做命令或者查询语句发送给解释器，这些恶意数据可以欺骗解释器，从而执行计划外的命令或者未授权访问数据。注入漏洞通常能SQL查询、LDAP查询、OS命令、程序参数等中出现。

### 条件

​	数据没有经过程序的验证过滤

### 防御

```
1、使用安全的api，避免使用解释器，使用预编译语句
2、对输入的特殊字符进行Escape转义处理
3、使用白名单来规范化的输入验证方法
4、权限最小化，减轻被注入的影响
```

## 失效的身份认证和会话管理

### 原理

​	弱口令，密码泄露，暴力破解，明文密码

与认证和会话管理相关的应用程序功能往往得不到正确管理，这就导致攻击者破坏密码、密匙、会话令牌或利用实施漏洞冒充其他用户身份。

### 防御

```
1、使用多因素身份认证
2、不使用默认密码（弱口令）
3、加token（令牌）
4、确保SSL在任何时候都会保护会话

会话管理：当用户不操作时，系统必须自动终止超时会话，必须有时间限制；必须提供退出功能，允许用户强制退出会话；会话标识足够随机，防止攻击者猜测到标识；用户登录后必须分配新的会话标识，不使用用户未登录前所使用的标识，防止会话攻击

```

## 敏感数据泄露

### 原理

​	中间人攻击，明文数据

最常见的漏洞是应该进行加密的数据没有进行加密。使用加密的情况下常见问题是不安全的密钥和使用弱算法加密。

### 方式

​	如burp抓包，修改后发包。

### 防御

```
1、所有敏感数据加密处理
2、确保传输过程中数据被加密（如使用https）
3、使用密码专用算法
4、动态加密
```

## XML外部实体（XXE）

### 原理

​	上传XML文档或者在 XML文档中添加恶意内容

### 防御

```
1、使用尽可能简单的数据格式（如json），避免对敏感数据进行序列化
2、服务器使用白名单进行输入验证，过滤等，防止出现恶意数据
```

## 失效的访问控制

### 原理

​	通过对访问控制的利用实现权限绕过，提升权限

### 防御

```
1、基于角色的访问控制
2、使用最小权限
3、记录失败的访问控制，并适当时向管理员报警
```

## 安全配置错误

### 原理

​	够通过未修复的漏洞、 访问默认账户、不再使用的页面、未受保护的文件和目录等来取得对系统的未授权的访问或了解。

默认值通常是不安全的。另外，软件应该保持更新。攻击者通过访问默认账户、未使用的网页、未安装补丁的漏洞、未被保护的文件和目录等，以获得对系统未授权的访问。

### 防御

```
1、搭建最小平台，不要任何不必要的功能、组件、文档等
2、及时安装更新和补丁
3、使用提供有效分离和安全性强大的应用程序架构
```

## 跨站脚本（XSS）

### 原理

​	篡改网页，插入了恶意脚本，从而在用户浏览网页时，控制用户的浏览器。

当应用程序在发送给浏览器的页面中包含用户提供的数据，但没有经过适当验证或转译，就会导致跨站脚本漏洞。XSS允许攻击者在受害者的浏览器中执行脚本，这些脚本可以劫持用户会话，破坏网站，或将用户重定向到恶意站点。

> 反射型、存储型、DOM型

### 危害

​	盗取session、账户（cookie）以及其他多种攻击

### 防御

```
1、（使用安全策略）如httpOnly解决XSS的COOKIE劫持
2、对所有不可信的输入数据进行恰当的转义escape
3、使用白名单的具有恰当的规范化解码功能的输入验证方法
```

## 不安全的反序列化

### 原理

​	把内存、文件、数据库中或者在网络通信中传输的文本格式或字节流格式还原成对象。

### 防御

```
1.对序列化对象执行完整性检查和加密处理，防止被恶意篡改和创建恶意对象
2.反序列化过程之前执行严格的类型限制
3.隔离反序列化的代码，将其放在低权限的状态下运行
4.监视反序列化的过程
```

## 使用含有已知漏洞的组件

### 原理

​	这些漏洞容易被攻击

### 防御

```
1、搭建最小平台
2、关注cve，cnvd这些 实时监控着
3、使用签名机制
```

## 不足的日志记录和监控

### 原理

​	不足的日志记录和监控，以及事件响应缺失或无效的集成，使攻击者能够进一步攻击系统、保持持续性或转向更多系统，以及篡改、提取或销毁数据。大多数缺陷研究显示，缺陷被检测出的时间超过200天，且通常通过外部检测方检测，而不是通过内部流程或监控检测。

### 防御 

```
1、确保所有敏感事件记录到日志中
2、建立有效的监控和告警机制，使可疑活动在可接受的时间内被发现和应对
```

**引用：https://netsecurity.51cto.com/art/202003/611597.htm**

